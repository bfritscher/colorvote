export function __vite_legacy_guard(){import("data:text/javascript,")}import{r as o,o as e,c as t,a as s,b as r,w as n,d as a,p as i,e as l,f as c,F as d,g as m,t as u,h as v,i as p,S as f,j as h,u as g,k as w,l as b,m as k,P as A,M as C,K as y,C as O,n as x,q as I,s as R,v as S,x as N,y as V,z as E,A as _,B as T,D as L,E as D,V as U,G as q,H as j,I as J,J as Q,L as G,N as B,O as F,Q as $,R as M,T as P,U as z}from"./vendor.1bcb5cc7.js";!function(){const o=document.createElement("link").relList;if(!(o&&o.supports&&o.supports("modulepreload"))){for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver((o=>{for(const t of o)if("childList"===t.type)for(const o of t.addedNodes)"LINK"===o.tagName&&"modulepreload"===o.rel&&e(o)})).observe(document,{childList:!0,subtree:!0})}function e(o){if(o.ep)return;o.ep=!0;const e=function(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),"use-credentials"===o.crossorigin?e.credentials="include":"anonymous"===o.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(o);fetch(o.href,e)}}();var H=(o,e)=>{for(const[t,s]of e)o[t]=s;return o};const K={setup(){}},Y=o=>(i("data-v-63f6f862"),o=o(),l(),o),X={class:"logo"},Z=a("ColorVote"),W=Y((()=>s("div",{id:"logo"},[s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div")],-1)));var oo=H(K,[["render",function(a,i,l,c,d,m){const u=o("router-link");return e(),t("div",null,[s("h1",X,[r(u,{to:"/"},{default:n((()=>[Z])),_:1})]),W])}],["__scopeId","data-v-63f6f862"]]);const eo={name:"Home",components:{Logo:oo},setup:()=>({rooms:c((()=>{const o=Bo.rooms.map((o=>({name:o,admin:$o(o)})));return o.sort(((o,e)=>o.name.localeCompare(e.name))),o})),createRoom:Ho,joinRoom:Po})},to=a("about"),so={class:"rooms"},ro=["onClick"],no=["onClick"];var ao=H(eo,[["render",function(i,l,c,f,h,g){const w=o("logo"),b=o("router-link");return e(),t("div",null,[r(w),r(b,{class:"about",to:"/about",title:"about"},{default:n((()=>[to])),_:1}),s("div",so,[s("div",{class:"room add-room",onClick:l[0]||(l[0]=o=>f.createRoom())},"+ Créer un Vote"),(e(!0),t(d,null,m(f.rooms,(o=>(e(),t("div",{key:o.name,class:"room",onClick:e=>f.joinRoom(o.name)},[a(u(o.name)+" ",1),o.admin?(e(),t("span",{key:0,class:"rename-room",onClick:v((e=>f.joinRoom(o.name,o.admin)),["stop"])},"admin",8,no)):p("",!0)],8,ro)))),128))])])}]]);const io={name:"About",components:{Logo:oo}},lo=(o=>(i("data-v-183e9de0"),o=o(),l(),o))((()=>s("div",{id:"container"},[s("div",{class:"inner"},[s("section",{id:"main_content"},[s("h2",null,"Votation anonyme, rapide et multiplatforme"),s("p",null," "),s("h3",null,"Présentation"),s("p",{class:"center"},[s("iframe",{src:"http://www.slideshare.net/slideshow/embed_code/28555735",width:"595",height:"485",frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"no",style:{border:"1px solid #ccc","border-width":"1px 1px 0","margin-bottom":"5px"},allowfullscreen:""},"\n            ")]),s("p",null,[a(" Téléchargez le guide: "),s("a",{href:"/downloads/ColorvoteGuide.pdf"},"ColorvoteGuide.pdf")]),s("p",{class:"center"},[s("iframe",{width:"620",height:"349",src:"//www.youtube.com/embed/3us5FfN0BiE?rel=0",frameborder:"0",allowfullscreen:""})]),s("h3",null,"Poster"),s("p",{class:"center"},[s("a",{href:"/images/colorvote_poster.png"},[s("img",{src:"/images/colorvote_poster_thumb.png",alt:"poster"})])]),s("h3",null,"Contact"),s("p",null,[a(" contact "),s("a",{href:"mailto:boris@colorvote.ch"},"boris@colorvote.ch")]),s("h3",null,"Technique"),s("p",null,"ColorVote utilise: Vue.js, node, socket.io"),s("p",null,[s("a",{href:"https://github.com/bfritscher/colorvote",id:"view-on-github",class:"button"},[s("span",null,"View on GitHub")])])]),s("footer",null,[a(" Colorvote is maintained by "),s("a",{href:"https://github.com/bfritscher"},"Boris Fritscher"),s("br")])])],-1)));var co=H(io,[["render",function(s,n,a,i,l,c){const d=o("logo");return e(),t("div",null,[r(d),lo])}],["__scopeId","data-v-183e9de0"]]);const mo={name:"Voter",components:{Swiper:f,SwiperSlide:h},setup(){const o=g();w((()=>{var e;o.params.roomName!==(null==(e=Bo.room)?void 0:e.name)&&(Bo.room&&zo(Bo.room.name),o.params.roomName&&Po(o.params.roomName))}));const e=b(null),t=k({sessionId:void 0,choice:void 0}),s=b(!1),r=c((()=>{var o;const e=[];for(let t=0;t<(null==(o=Bo.room)?void 0:o.nbOptions);t++)e.push(t);return e})),n=c((()=>{var o;return new Array(null==(o=Bo.room)?void 0:o.nbOptions).fill(0).map(((o,e)=>({id:e,title:e})))})),a=o=>{t.choice=o,e.value&&e.value.realIndex!==o&&e.value.slideToLoop(o),function(o){var e;Mo.emit("vote",null==(e=Bo.room)?void 0:e.name,Bo.userId,o)}(o),localStorage.setItem(`COLORVOTE_VOTE__${Bo.room.name}`,JSON.stringify(t))};w((()=>{var o;Bo.room&&Bo.room.sessionId!==t.sessionId&&(console.log("set session id",Bo.room.sessionId),t.sessionId=Bo.room.sessionId,t.choice=void 0);const e=JSON.parse(localStorage.getItem(`COLORVOTE_VOTE__${null==(o=Bo.room)?void 0:o.name}`)||"{}");console.log(e,Bo.room),e&&Bo.room&&Bo.room.sessionId===e.sessionId&&a(e.choice)}));return{modules:[A,C,y,O],slides:n,onSlideChange:()=>{e.value&&a(e.value.realIndex)},state:Bo,showCardVote:s,vote:t,choices:r,setVote:a,setControlledSwiper(o){e.value=o,t.choice&&e.value.slideToLoop(t.choice)}}}},uo={class:"title"},vo=a(" ... "),po={class:"room-title"},fo=["onClick"],ho={class:"title"},go={key:1,class:"votenow"},wo={key:2,class:"voting-stopped"},bo=[s("h1",null,"Votation terminée",-1)],ko=a("<");var Ao=H(mo,[["render",function(a,i,l,c,f,h){var g;const w=o("swiper-slide"),b=o("swiper"),k=o("router-link");return c.state.room?(e(),t(d,{key:0},[r(b,{modules:c.modules,"slides-per-view":1,"space-between":50,loop:!0,pagination:{clickable:!0},onSlideChange:c.onSlideChange,onSwiper:c.setControlledSwiper},{default:n((()=>[(e(!0),t(d,null,m(c.slides,(o=>(e(),x(w,{key:o.id,class:I(`color-${o.id}`)},{default:n((()=>[s("div",uo,u(o.title),1)])),_:2},1032,["class"])))),128)),vo])),_:1},8,["modules","onSlideChange","onSwiper"]),s("div",po,u(null==(g=c.state.room)?void 0:g.name),1),s("div",{class:"show-card-vote",onClick:i[0]||(i[0]=o=>c.showCardVote=!c.showCardVote)}),c.showCardVote?(e(),t("div",{key:0,class:"card-vote",onClick:i[1]||(i[1]=o=>c.showCardVote=!c.showCardVote)},[(e(!0),t(d,null,m(c.choices,(o=>(e(),t("div",{class:"card-wrapper",key:o},[s("div",{class:I(["card",`color-${o} ${c.vote.choice===o?"active":""}`]),onClick:v((e=>c.setVote(o)),["stop"])},[s("div",ho,u(o),1)],10,fo)])))),128))])):p("",!0),void 0===c.vote.choice?(e(),t("div",go,"Votez maintenant")):p("",!0),c.state.room&&"closed"!==c.state.room.status?p("",!0):(e(),t("div",wo,bo)),r(k,{class:"backLink",to:"/"},{default:n((()=>[ko])),_:1})],64)):p("",!0)}]]);const Co={name:"Chart",props:["data"],setup(o){const e=b(null);return R((()=>{w((()=>{!function(o,e){const t=30,s=20,r=30,n=40,a=500-n-s,i=500-t-r,l=S(".0%"),c=N().range([0,a]).round(.1),d=V().range([i,0]),m=Object.keys(e).map((o=>parseInt(o))),u=D(c),v=E(e),p=_(d).tickFormat(S("d")),f=T(o).attr("width",a+n+s).attr("height",i+t+r).select("g.transform").attr("transform","translate("+n+","+t+")");c.domain(m),d.domain([0,L(e)]),f.select("g.x.axis").attr("transform","translate(0,"+i+")").call(u),f.select("g.y.axis").transition().duration(1e3).call(p);const h=f.selectAll(".bar").data(e.map(((o,e)=>({key:e,value:o})))),g=h.enter().append("g").attr("class","bar").attr("transform",(o=>"translate("+c(o.key)+",0)"));g.append("rect").attr("class",(o=>"color-"+o.key)).attr("width",c.bandwidth()).attr("y",(o=>d(o.value))).attr("height",(o=>i-d(o.value))),g.append("text").attr("x",c.bandwidth()/2-12).attr("y",(o=>d(o.value)-8)),h.attr("transform",(o=>"translate("+c(o.key)+",0)")),h.select("rect").transition().duration(1e3).attr("y",(o=>d(o.value))).attr("height",(o=>i-d(o.value))),h.select("rect").attr("width",c.bandwidth()),h.select("text").transition().duration(1e3).text((o=>l(o.value/v||0))).attr("y",(o=>d(o.value)-8)),h.select("text").attr("x",c.bandwidth()/2-12),h.exit().remove()}(e.value,o.data)}))})),{svgRef:e}}},yo={ref:"svgRef",width:"500",height:"500",class:"chart"},Oo=[s("g",{class:"transform"},[s("g",{class:"x axis"}),s("g",{class:"y axis"})],-1)];const xo={name:"Asker",components:{VueQrcode:U,Chart:H(Co,[["render",function(o,s,r,n,a,i){return e(),t("svg",yo,Oo,512)}]]),Logo:oo},setup(){const o=g(),e=q();w((()=>{var e;o.params.roomName!==(null==(e=Bo.room)?void 0:e.name)&&(Bo.room&&zo(Bo.room.name),o.params.roomName&&Po(o.params.roomName,$o(o.params.roomName)))}));const t=k({showqrcode:!1,showresults:!1}),s=c((()=>`${window.location.origin}/${e.resolve({name:"voter",params:{rootName:Bo.room.name}}).href}`)),r=c((()=>{var o;return Object.values((null==(o=Bo.room)?void 0:o.results)||{}).reduce(((o,e)=>o+e),0)})),n=c((()=>{var o;try{const e=B(Bo.tokens[null==(o=Bo.room)?void 0:o.name]);return new Date(1e3*e.exp)}catch(e){return new Date}}));function a(o,e){for(o=o.toString();o.length<e;)o="0"+o;return o}let i;const l=b(""),d=b("");return R((()=>{i=setInterval((()=>{Bo.room&&"open"===Bo.room.status?l.value=function(){let o=j().diff(Bo.room.sessionId);o=Math.round(o/1e3);const e=o%60;return a((o-e)/60,2)+":"+a(e,2)}():l.value="00:00",d.value=j(n.value).fromNow()}))})),J((()=>{clearInterval(i)})),{href:s,ui:t,state:Bo,votesTotal:r,remainingTime:d,confirmDestroy(){confirm("Are you sure you want to destroy this room?")&&function(){var o;const e=null==(o=Bo.room)?void 0:o.name;Mo.emit("close",$o(e)),delete Bo.tokens[e],Fo()}()},extendRoom:Ko,sendCurrentRoomConfig:Yo,elapsedTime:l,switchStatus(){var o;"closed"===(null==(o=Bo.room)?void 0:o.status)?(t.showresults=!1,Bo.room.status="open",Bo.room.sessionId=(new Date).getTime()):(t.showresults=!0,Bo.room.status="closed"),Yo()}}}},Io={style:{display:"flex","flex-direction":"column",height:"100%"}},Ro={class:"room-title"},So={class:"room-stats"},No=s("br",null,null,-1),Vo={key:0,id:"voting-admin-panel"},Eo={class:"timer"},_o=a(" votes: "),To={class:"votesCount"},Lo=a("<"),Do={key:1,class:"liveresults"},Uo={key:0},qo=a("nombres de choix "),jo=s("div",{style:{flex:"1"}},null,-1),Jo={id:"advanced_options"};const Qo=[{path:"/",component:ao},{path:"/about",component:co},{path:"/:roomName/admin",component:H(xo,[["render",function(i,l,c,d,m,f){var h;const g=o("logo"),w=o("vue-qrcode"),b=o("router-link"),k=o("chart");return e(),t("div",Io,[r(g),s("div",Ro,u(null==(h=d.state.room)?void 0:h.name),1),s("div",So,[a(u(d.votesTotal),1),No,s("span",null,u(d.state.count),1)]),d.state.room?(e(),t("div",Vo,[s("span",Eo,u(d.elapsedTime),1),s("button",{id:"questionAction",class:I({new:"closed"===d.state.room.status,stop:"closed"!=d.state.room.status}),onClick:l[0]||(l[0]=o=>d.switchStatus())},u("closed"==d.state.room.status?"NOUVEAU":"TERMINER"),3),_o,s("span",To,u(d.votesTotal),1),r(w,{id:"showqrcode",title:"afficher le QRCode",value:d.href,width:40,type:"image/png",color:{dark:"#000000ff",light:"#ffffffff"},quality:.92,onClick:l[1]||(l[1]=o=>d.ui.showqrcode=!d.ui.showqrcode)},null,8,["value","quality"]),s("img",{id:"toggleResults",alt:"afficher résultats",title:"afficher résultats",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAJtJREFUWEftjcEJQlEMBG3ABrx7sgfr8ebdLi3g12AJ8YVd+GH/Q9AIHtxhTtnA7OJHvAo/Dqet3No4XJEk5NbG4YokIbc2DlckCbm1cbgiScitzUfhy3FixG25bs3/GQ5XJAlzkCR0mOb/DIcrkoQ5SBI6TPN/xv+Gz4v6vfD+rg4cXnWY5rMkocN03KU6HDi86jDNZ0nCt8IRTzfZRmDQJl1BAAAAAElFTkSuQmCC",onClick:l[2]||(l[2]=o=>d.ui.showresults=!d.ui.showresults)}),r(b,{class:"backLink",to:"/"},{default:n((()=>[Lo])),_:1})])):p("",!0),d.ui.showresults&&d.state.room?(e(),t("div",Do,[r(k,{data:d.state.room.results.slice(0,d.state.room.nbOptions)},null,8,["data"]),"open"==d.state.room.status?(e(),t("div",Uo,[s("label",null,[qo,Q(s("input",{type:"range",step:"1",min:"2",max:"8","onUpdate:modelValue":l[3]||(l[3]=o=>d.state.room.nbOptions=o),onChange:l[4]||(l[4]=o=>d.sendCurrentRoomConfig())},null,544),[[G,d.state.room.nbOptions,void 0,{number:!0}]]),a(" "+u(d.state.room.nbOptions),1)])])):p("",!0)])):p("",!0),jo,s("div",Jo,[a(" Room expires "+u(d.remainingTime)+" ",1),s("button",{onClick:l[5]||(l[5]=(...o)=>d.extendRoom&&d.extendRoom(...o))},"extend +1h"),s("button",{onClick:l[6]||(l[6]=(...o)=>d.confirmDestroy&&d.confirmDestroy(...o))},"destroy room")]),d.ui.showqrcode?(e(),t("div",{key:2,id:"qrCodePanel",onClick:l[8]||(l[8]=o=>d.ui.showqrcode=!1)},[r(w,{value:d.href,width:400,type:"image/png",color:{dark:"#000000ff",light:"#ffffffff"},quality:.92},null,8,["value","quality"]),s("h1",{class:"user-select",onClick:l[7]||(l[7]=v((()=>{}),["stop"]))},u(d.href),1)])):p("",!0)])}]]),name:"asker"},{path:"/:roomName",component:Ao,name:"voter"}],Go=F({history:$(),routes:Qo}),Bo=k({roomName:"",rooms:[],userId:function(){const o=localStorage.getItem("COLORVOTE_UUID");if(o)return o;const e=M();return localStorage.setItem("COLORVOTE_UUID",e),e}(),tokens:function(){const o=JSON.parse(localStorage.getItem("COLORVOTE_TOKENS")||"[]"),e={};return o.forEach((o=>{const t=B(o);t.exp>Date.now()/1e3&&(e[t.r]=o)})),e}(),connected:!1,error:null,count:0});function Fo(){localStorage.setItem("COLORVOTE_TOKENS",JSON.stringify(Object.values(Bo.tokens)))}function $o(o){const e=localStorage.getItem("COLORVOTE_SUPERUSER");return e?`SUPERUSER|${o}|${e}`:Bo.tokens[o]}const Mo=P("https://api.colorvote.ch");function Po(o,e){Mo.emit("join",o,e)}function zo(o){Mo.emit("leave",o)}function Ho(){const o=prompt("Nom de la salle?");o&&Mo.emit("create",o,(e=>{Bo.tokens[o]=e,Fo(),Po(o,e)}))}function Ko(){var o;const e=null==(o=Bo.room)?void 0:o.name;Mo.emit("extend",$o(e),(o=>{Bo.tokens[e]=o,Fo()}))}function Yo(){var o;Mo.emit("config",{s:Bo.room.status,o:Bo.room.nbOptions,i:Bo.room.sessionId},$o(null==(o=Bo.room)?void 0:o.name))}Mo.on("connect",(()=>{Bo.connected=!0})),Mo.on("disconnect",(()=>{Bo.connected=!1})),Mo.on("error",(o=>{Bo.error=o,Go.push("/")})),Mo.on("count",(o=>{Bo.count=o})),Mo.on("rooms",(o=>{Bo.rooms=o})),Mo.on("info",(o=>{if(Bo.error=null,Bo.room=function(o){return{name:o.n,status:o.s,sessionId:o.i,nbOptions:o.o,results:o.r}}(o),!Go.currentRoute.params||Go.currentRoute.params.roomName!=Bo.room.name){let o=`/${Bo.room.name}`;Bo.room.results&&(o+="/admin"),Go.push(o)}})),Mo.on("closed",(()=>{Bo.room=null,Go.push("/")}));const Xo={class:"wrapper"},Zo={key:0,id:"errormsg"},Wo={key:1,id:"reconnecting"};z(H({setup:()=>({state:Bo})},[["render",function(s,n,a,i,l,c){const d=o("router-view");return e(),t("div",Xo,[i.state.error?(e(),t("div",Zo,u(i.state.error),1)):p("",!0),i.state.connected?p("",!0):(e(),t("div",Wo,"reconnecting")),r(d)])}]])).use(Go).mount("#app");
