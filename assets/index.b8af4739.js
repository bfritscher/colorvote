export function __vite_legacy_guard(){import("data:text/javascript,")}import{r as o,o as e,c as t,a as s,b as r,w as n,d as a,p as i,e as l,f as c,F as d,g as u,t as m,h as v,i as p,S as f,j as h,u as g,k as w,l as k,m as b,P as A,M as C,K as y,C as O,n as x,q as I,s as R,v as S,x as N,y as V,z as E,A as _,B as T,D as L,E as D,V as q,G as U,H as j,I as J,J as Q,L as G,N as B,O as F,Q as $,R as M,T as P}from"./vendor.767378ee.js";!function(){const o=document.createElement("link").relList;if(!(o&&o.supports&&o.supports("modulepreload"))){for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver((o=>{for(const t of o)if("childList"===t.type)for(const o of t.addedNodes)"LINK"===o.tagName&&"modulepreload"===o.rel&&e(o)})).observe(document,{childList:!0,subtree:!0})}function e(o){if(o.ep)return;o.ep=!0;const e=function(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerpolicy&&(e.referrerPolicy=o.referrerpolicy),"use-credentials"===o.crossorigin?e.credentials="include":"anonymous"===o.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(o);fetch(o.href,e)}}();var z=(o,e)=>{for(const[t,s]of e)o[t]=s;return o};const H={setup(){}},K=o=>(i("data-v-63f6f862"),o=o(),l(),o),Y={class:"logo"},X=a("ColorVote"),Z=K((()=>s("div",{id:"logo"},[s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div")],-1)));var W=z(H,[["render",function(a,i,l,c,d,u){const m=o("router-link");return e(),t("div",null,[s("h1",Y,[r(m,{to:"/"},{default:n((()=>[X])),_:1})]),Z])}],["__scopeId","data-v-63f6f862"]]);const oo={name:"Home",components:{Logo:W},setup:()=>({rooms:c((()=>{const o=Go.rooms.map((o=>({name:o,admin:Fo(o)})));return o.sort(((o,e)=>o.name.localeCompare(e.name))),o})),createRoom:zo,joinRoom:Mo})},eo=a("about"),to={class:"rooms"},so=["onClick"],ro=["onClick"];var no=z(oo,[["render",function(i,l,c,f,h,g){const w=o("logo"),k=o("router-link");return e(),t("div",null,[r(w),r(k,{class:"about",to:"/about",title:"about"},{default:n((()=>[eo])),_:1}),s("div",to,[s("div",{class:"room add-room",onClick:l[0]||(l[0]=o=>f.createRoom())},"+ Créer un Vote"),(e(!0),t(d,null,u(f.rooms,(o=>(e(),t("div",{key:o.name,class:"room",onClick:e=>f.joinRoom(o.name)},[a(m(o.name)+" ",1),o.admin?(e(),t("span",{key:0,class:"rename-room",onClick:v((e=>f.joinRoom(o.name,o.admin)),["stop"])},"admin",8,ro)):p("",!0)],8,so)))),128))])])}]]);const ao={name:"About",components:{Logo:W}},io=(o=>(i("data-v-183e9de0"),o=o(),l(),o))((()=>s("div",{id:"container"},[s("div",{class:"inner"},[s("section",{id:"main_content"},[s("h2",null,"Votation anonyme, rapide et multiplatforme"),s("p",null," "),s("h3",null,"Présentation"),s("p",{class:"center"},[s("iframe",{src:"http://www.slideshare.net/slideshow/embed_code/28555735",width:"595",height:"485",frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"no",style:{border:"1px solid #ccc","border-width":"1px 1px 0","margin-bottom":"5px"},allowfullscreen:""},"\n            ")]),s("p",null,[a(" Téléchargez le guide: "),s("a",{href:"/downloads/ColorvoteGuide.pdf"},"ColorvoteGuide.pdf")]),s("p",{class:"center"},[s("iframe",{width:"620",height:"349",src:"//www.youtube.com/embed/3us5FfN0BiE?rel=0",frameborder:"0",allowfullscreen:""})]),s("h3",null,"Poster"),s("p",{class:"center"},[s("a",{href:"/images/colorvote_poster.png"},[s("img",{src:"/images/colorvote_poster_thumb.png",alt:"poster"})])]),s("h3",null,"Contact"),s("p",null,[a(" contact "),s("a",{href:"mailto:boris@colorvote.ch"},"boris@colorvote.ch")]),s("h3",null,"Technique"),s("p",null,"ColorVote utilise: Vue.js, node, socket.io"),s("p",null,[s("a",{href:"https://github.com/bfritscher/colorvote",id:"view-on-github",class:"button"},[s("span",null,"View on GitHub")])])]),s("footer",null,[a(" Colorvote is maintained by "),s("a",{href:"https://github.com/bfritscher"},"Boris Fritscher"),s("br")])])],-1)));var lo=z(ao,[["render",function(s,n,a,i,l,c){const d=o("logo");return e(),t("div",null,[r(d),io])}],["__scopeId","data-v-183e9de0"]]);const co={name:"Voter",components:{Swiper:f,SwiperSlide:h},setup(){const o=g();w((()=>{var e;o.params.roomName!==(null==(e=Go.room)?void 0:e.name)&&(Go.room&&Po(Go.room.name),o.params.roomName&&Mo(o.params.roomName))}));const e=k(null),t=b({sessionId:void 0,choice:void 0}),s=k(!1),r=c((()=>{var o;const e=[];for(let t=0;t<(null==(o=Go.room)?void 0:o.nbOptions);t++)e.push(t);return e})),n=c((()=>{var o;return new Array(null==(o=Go.room)?void 0:o.nbOptions).fill(0).map(((o,e)=>({id:e,title:e})))})),a=o=>{t.choice=o,e.value&&e.value.realIndex!==o&&e.value.slideToLoop(o),function(o){var e;$o.emit("vote",null==(e=Go.room)?void 0:e.name,Go.userId,o)}(o),localStorage.setItem(`COLORVOTE_VOTE__${Go.room.name}`,JSON.stringify(t))};w((()=>{var o;Go.room&&Go.room.sessionId!==t.sessionId&&(console.log("set session id",Go.room.sessionId),t.sessionId=Go.room.sessionId,t.choice=void 0);const e=JSON.parse(localStorage.getItem(`COLORVOTE_VOTE__${null==(o=Go.room)?void 0:o.name}`)||"{}");console.log(e,Go.room),e&&Go.room&&Go.room.sessionId===e.sessionId&&a(e.choice)}));return{modules:[A,C,y,O],slides:n,onSlideChange:()=>{e.value&&a(e.value.realIndex)},state:Go,showCardVote:s,vote:t,choices:r,setVote:a,setControlledSwiper(o){e.value=o,t.choice&&e.value.slideToLoop(t.choice)}}}},uo={class:"title"},mo=a(" ... "),vo={class:"room-title"},po=["onClick"],fo={class:"title"},ho={key:1,class:"votenow"},go={key:2,class:"voting-stopped"},wo=[s("h1",null,"Votation terminée",-1)],ko=a("<");var bo=z(co,[["render",function(a,i,l,c,f,h){var g;const w=o("swiper-slide"),k=o("swiper"),b=o("router-link");return c.state.room?(e(),t(d,{key:0},[r(k,{modules:c.modules,"slides-per-view":1,"space-between":50,loop:!0,pagination:{clickable:!0},onSlideChange:c.onSlideChange,onSwiper:c.setControlledSwiper},{default:n((()=>[(e(!0),t(d,null,u(c.slides,(o=>(e(),x(w,{key:o.id,class:I(`color-${o.id}`)},{default:n((()=>[s("div",uo,m(o.title),1)])),_:2},1032,["class"])))),128)),mo])),_:1},8,["modules","onSlideChange","onSwiper"]),s("div",vo,m(null==(g=c.state.room)?void 0:g.name),1),s("div",{class:"show-card-vote",onClick:i[0]||(i[0]=o=>c.showCardVote=!c.showCardVote)}),c.showCardVote?(e(),t("div",{key:0,class:"card-vote",onClick:i[1]||(i[1]=o=>c.showCardVote=!c.showCardVote)},[(e(!0),t(d,null,u(c.choices,(o=>(e(),t("div",{class:"card-wrapper",key:o},[s("div",{class:I(["card",`color-${o} ${c.vote.choice===o?"active":""}`]),onClick:v((e=>c.setVote(o)),["stop"])},[s("div",fo,m(o),1)],10,po)])))),128))])):p("",!0),void 0===c.vote.choice?(e(),t("div",ho,"Votez maintenant")):p("",!0),c.state.room&&"closed"!==c.state.room.status?p("",!0):(e(),t("div",go,wo)),r(b,{class:"backLink",to:"/"},{default:n((()=>[ko])),_:1})],64)):p("",!0)}]]);const Ao={name:"Chart",props:["data"],setup(o){const e=k(null);return R((()=>{w((()=>{!function(o,e){const t=30,s=20,r=30,n=40,a=500-n-s,i=500-t-r,l=S(".0%"),c=N().range([0,a]).round(.1),d=V().range([i,0]),u=Object.keys(e).map((o=>parseInt(o))),m=D(c),v=E(e),p=_(d).tickFormat(S("d")),f=T(o).attr("width",a+n+s).attr("height",i+t+r).select("g.transform").attr("transform","translate("+n+","+t+")");c.domain(u),d.domain([0,L(e)]),f.select("g.x.axis").attr("transform","translate(0,"+i+")").call(m),f.select("g.y.axis").transition().duration(1e3).call(p);const h=f.selectAll(".bar").data(e.map(((o,e)=>({key:e,value:o})))),g=h.enter().append("g").attr("class","bar").attr("transform",(o=>"translate("+c(o.key)+",0)"));g.append("rect").attr("class",(o=>"color-"+o.key)).attr("width",c.bandwidth()).attr("y",(o=>d(o.value))).attr("height",(o=>i-d(o.value))),g.append("text").attr("x",c.bandwidth()/2-12).attr("y",(o=>d(o.value)-8)),h.attr("transform",(o=>"translate("+c(o.key)+",0)")),h.select("rect").transition().duration(1e3).attr("y",(o=>d(o.value))).attr("height",(o=>i-d(o.value))),h.select("rect").attr("width",c.bandwidth()),h.select("text").transition().duration(1e3).text((o=>l(o.value/v||0))).attr("y",(o=>d(o.value)-8)),h.select("text").attr("x",c.bandwidth()/2-12),h.exit().remove()}(e.value,o.data)}))})),{svgRef:e}}},Co={ref:"svgRef",width:"500",height:"500",class:"chart"},yo=[s("g",{class:"transform"},[s("g",{class:"x axis"}),s("g",{class:"y axis"})],-1)];const Oo={name:"Asker",components:{VueQrcode:q,Chart:z(Ao,[["render",function(o,s,r,n,a,i){return e(),t("svg",Co,yo,512)}]]),Logo:W},setup(){const o=g();w((()=>{var e;o.params.roomName!==(null==(e=Go.room)?void 0:e.name)&&(Go.room&&Po(Go.room.name),o.params.roomName&&Mo(o.params.roomName,Fo(o.params.roomName)))}));const e=b({showqrcode:!1,showresults:!1}),t=c((()=>{var o;return`${window.location.origin}/${null==(o=Go.room)?void 0:o.name}`})),s=c((()=>{var o;return Object.values((null==(o=Go.room)?void 0:o.results)||{}).reduce(((o,e)=>o+e),0)})),r=c((()=>{var o;try{const e=G(Go.tokens[null==(o=Go.room)?void 0:o.name]);return new Date(1e3*e.exp)}catch(e){return new Date}}));function n(o,e){for(o=o.toString();o.length<e;)o="0"+o;return o}let a;const i=k(""),l=k("");return R((()=>{a=setInterval((()=>{Go.room&&"open"===Go.room.status?i.value=function(){let o=U().diff(Go.room.sessionId);o=Math.round(o/1e3);const e=o%60;return n((o-e)/60,2)+":"+n(e,2)}():i.value="00:00",l.value=U(r.value).fromNow()}))})),j((()=>{clearInterval(a)})),{href:t,ui:e,state:Go,votesTotal:s,remainingTime:l,confirmDestroy(){confirm("Are you sure you want to destroy this room?")&&function(){var o;const e=null==(o=Go.room)?void 0:o.name;$o.emit("close",Fo(e)),delete Go.tokens[e],Bo()}()},extendRoom:Ho,sendCurrentRoomConfig:Ko,elapsedTime:i,switchStatus(){var o;"closed"===(null==(o=Go.room)?void 0:o.status)?(e.showresults=!1,Go.room.status="open",Go.room.sessionId=(new Date).getTime()):(e.showresults=!0,Go.room.status="closed"),Ko()}}}},xo={style:{display:"flex","flex-direction":"column",height:"100%"}},Io={class:"room-title"},Ro={class:"room-stats"},So=s("br",null,null,-1),No={key:0,id:"voting-admin-panel"},Vo={class:"timer"},Eo=a(" votes: "),_o={class:"votesCount"},To=a("<"),Lo={key:1,class:"liveresults"},Do={key:0},qo=a("nombres de choix "),Uo=s("div",{style:{flex:"1"}},null,-1),jo={id:"advanced_options"};const Jo=[{path:"/",component:no},{path:"/about",component:lo},{path:"/:roomName/admin",component:z(Oo,[["render",function(i,l,c,d,u,f){var h;const g=o("logo"),w=o("vue-qrcode"),k=o("router-link"),b=o("chart");return e(),t("div",xo,[r(g),s("div",Io,m(null==(h=d.state.room)?void 0:h.name),1),s("div",Ro,[a(m(d.votesTotal),1),So,s("span",null,m(d.state.count),1)]),d.state.room?(e(),t("div",No,[s("span",Vo,m(d.elapsedTime),1),s("button",{id:"questionAction",class:I({new:"closed"===d.state.room.status,stop:"closed"!=d.state.room.status}),onClick:l[0]||(l[0]=o=>d.switchStatus())},m("closed"==d.state.room.status?"NOUVEAU":"TERMINER"),3),Eo,s("span",_o,m(d.votesTotal),1),r(w,{id:"showqrcode",title:"afficher le QRCode",value:d.href,width:40,type:"image/png",color:{dark:"#000000ff",light:"#ffffffff"},quality:.92,onClick:l[1]||(l[1]=o=>d.ui.showqrcode=!d.ui.showqrcode)},null,8,["value","quality"]),s("img",{id:"toggleResults",alt:"afficher résultats",title:"afficher résultats",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAIAAAADnC86AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAJtJREFUWEftjcEJQlEMBG3ABrx7sgfr8ebdLi3g12AJ8YVd+GH/Q9AIHtxhTtnA7OJHvAo/Dqet3No4XJEk5NbG4YokIbc2DlckCbm1cbgiScitzUfhy3FixG25bs3/GQ5XJAlzkCR0mOb/DIcrkoQ5SBI6TPN/xv+Gz4v6vfD+rg4cXnWY5rMkocN03KU6HDi86jDNZ0nCt8IRTzfZRmDQJl1BAAAAAElFTkSuQmCC",onClick:l[2]||(l[2]=o=>d.ui.showresults=!d.ui.showresults)}),r(k,{class:"backLink",to:"/"},{default:n((()=>[To])),_:1})])):p("",!0),d.ui.showresults&&d.state.room?(e(),t("div",Lo,[r(b,{data:d.state.room.results.slice(0,d.state.room.nbOptions)},null,8,["data"]),"open"==d.state.room.status?(e(),t("div",Do,[s("label",null,[qo,J(s("input",{type:"range",step:"1",min:"2",max:"8","onUpdate:modelValue":l[3]||(l[3]=o=>d.state.room.nbOptions=o),onChange:l[4]||(l[4]=o=>d.sendCurrentRoomConfig())},null,544),[[Q,d.state.room.nbOptions,void 0,{number:!0}]]),a(" "+m(d.state.room.nbOptions),1)])])):p("",!0)])):p("",!0),Uo,s("div",jo,[a(" Room expires "+m(d.remainingTime)+" ",1),s("button",{onClick:l[5]||(l[5]=(...o)=>d.extendRoom&&d.extendRoom(...o))},"extend +1h"),s("button",{onClick:l[6]||(l[6]=(...o)=>d.confirmDestroy&&d.confirmDestroy(...o))},"destroy room")]),d.ui.showqrcode?(e(),t("div",{key:2,id:"qrCodePanel",onClick:l[8]||(l[8]=o=>d.ui.showqrcode=!1)},[r(w,{value:d.href,width:400,type:"image/png",color:{dark:"#000000ff",light:"#ffffffff"},quality:.92},null,8,["value","quality"]),s("h1",{class:"user-select",onClick:l[7]||(l[7]=v((()=>{}),["stop"]))},m(d.href),1)])):p("",!0)])}]]),name:"asker"},{path:"/:roomName",component:bo,name:"voter"}],Qo=B({history:F(),routes:Jo}),Go=b({roomName:"",rooms:[],userId:function(){const o=localStorage.getItem("COLORVOTE_UUID");if(o)return o;const e=$();return localStorage.setItem("COLORVOTE_UUID",e),e}(),tokens:function(){const o=JSON.parse(localStorage.getItem("COLORVOTE_TOKENS")||"[]"),e={};return o.forEach((o=>{const t=G(o);t.exp>Date.now()/1e3&&(e[t.r]=o)})),e}(),connected:!1,error:null,count:0});function Bo(){localStorage.setItem("COLORVOTE_TOKENS",JSON.stringify(Object.values(Go.tokens)))}function Fo(o){const e=localStorage.getItem("COLORVOTE_SUPERUSER");return e?`SUPERUSER|${o}|${e}`:Go.tokens[o]}const $o=M("https://api.colorvote.ch");function Mo(o,e){$o.emit("join",o,e)}function Po(o){$o.emit("leave",o)}function zo(){const o=prompt("Nom de la salle?");o&&$o.emit("create",o,(e=>{Go.tokens[o]=e,Bo(),Mo(o,e)}))}function Ho(){var o;const e=null==(o=Go.room)?void 0:o.name;$o.emit("extend",Fo(e),(o=>{Go.tokens[e]=o,Bo()}))}function Ko(){var o;$o.emit("config",{s:Go.room.status,o:Go.room.nbOptions,i:Go.room.sessionId},Fo(null==(o=Go.room)?void 0:o.name))}$o.on("connect",(()=>{Go.connected=!0})),$o.on("disconnect",(()=>{Go.connected=!1})),$o.on("error",(o=>{Go.error=o,Qo.push("/")})),$o.on("count",(o=>{Go.count=o})),$o.on("rooms",(o=>{Go.rooms=o})),$o.on("info",(o=>{if(Go.error=null,Go.room=function(o){return{name:o.n,status:o.s,sessionId:o.i,nbOptions:o.o,results:o.r}}(o),!Qo.currentRoute.params||Qo.currentRoute.params.roomName!=Go.room.name){let o=`/${Go.room.name}`;Go.room.results&&(o+="/admin"),Qo.push(o)}})),$o.on("closed",(()=>{Go.room=null,Qo.push("/")}));const Yo={class:"wrapper"},Xo={key:0,id:"errormsg"},Zo={key:1,id:"reconnecting"};P(z({setup:()=>({state:Go})},[["render",function(s,n,a,i,l,c){const d=o("router-view");return e(),t("div",Yo,[i.state.error?(e(),t("div",Xo,m(i.state.error),1)):p("",!0),i.state.connected?p("",!0):(e(),t("div",Zo,"reconnecting")),r(d)])}]])).use(Qo).mount("#app");
